# E2E 테스트란?

## 4.1 E2E 테스트란 무엇일까?

## 4.2 Cypress E2E 테스트 시작하기

cypress란

- 실제 웹 앱을 기준으로 다양한 테스트를 작성할 수 있는 오픈 소스 자동화 도구
- 브라우저 안과 밖에서 일어나는 상황을 제어할 수 있어 일관된 환경에서 테스트를 실행할 수 있다

- 실제 환경과 유사한 환경에서 테스트 => 안정성 향상
- 테스트 환경에 배포 후에 테스트 실행 가능하며, 유지 보수 증가

cypress:open(브라우저 구동head mode) vs cypress:run(브라우저 구동하지 않고 headless)

- head 모드 (브라우저 UI 까지 모두 구동)
- headless 모드 (브라우저 없이 브라우저 엔진을 명령어 인터페이스로 제어)

## 4.3 Cypress로 E2E 테스트 작성하기

E2E 테스트 작성하기 (Login.cy.js)

E2E 테스트는 컴포넌트 일부가 아닌 앱 자체에 대한 기능이 동작하는지 검증 -> 어디까지나 단위, 통합에서는 일부 컴포넌트의 조합을 테스트

- 통합 테스트로 검증한 기능을 파악하는 노력을 해서 분리해야 한다면 DX에 큰 장점이 없으므로 중복이 있더라도 전체를 테스트 하는데 집중해서 작성하기

### 명령어

- cy.visit = baseUrl을 기준으로 웹 페이지로 접속(react-router의 navigation과 동일)
- cypress.config.js에서 기본 설정
- retry-ability 기능 사용
- should로 match 단언 사용

E2E 테스트의 장점

- 실제 api를 호출하여 백엔드까지 연동했을 때 로그인의 성공 여부를 확인
- 메인페이지로 이동하여 사용자 계정 정보가 나타나는지 확인 가능

## 4.4 Cypress와 쿼리

cy.get() 으로 요소를 query 하면 가독성이 좀 떨어짐. 대신 다른 기능을 사용할 수 있음 (alias). beforeEach에서 alias 작성해서 이후 코드에서 alias로 접근

체이닝 형태로 테스트 코드를 작성하여 테스트 과정을 이해하기 쉬움, 코드를 간결하게 작성할 수 있음

- then () API 이전 커맨드의 subject를 실행 결과를 전달받아 사용

- Retry-ability = cypress의 핵심기능
  => 재시도 기능 (잠재적으로 업데이트 가능성이 있다고 판단해 원하는 상황이 발생할 때까지 특정 시간동안 재시도)
  default time은 4초 이나 재시도 시간을 변경할 수 있음
  - Query: 전체 체이닝 로직을 재시도하며 실행
  - Assertion: 단언을 수행하는 특별한 쿼리의 유형
  - Non-Query: 재시도를 하지 않으며, 단 한번만 실행되는 커맨드
